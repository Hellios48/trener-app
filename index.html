<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeonovTrener Funnel</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #007aff;
            --bg: #ffffff;
            --text: #000000;
            --secondary-bg: #f5f5f5;
            --gold: #FFD700;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            padding-bottom: 40px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ (—Å—Ç—Ä–∞–Ω–∏—Ü) */
        .page { display: none; animation: fadeIn 0.3s; }
        .active-page { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2, h3 { text-align: center; }
        h1 { color: var(--primary); margin-bottom: 10px; }
        
        .card {
            background: var(--secondary-bg);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        /* –°–ø–∏—Å–æ–∫ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ */
        .benefits-list { list-style: none; padding: 0; }
        .benefits-list li { margin-bottom: 15px; font-size: 15px; line-height: 1.5; }
        .check { color: #2ecc71; font-weight: bold; margin-right: 5px; }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            box-sizing: border-box;
        }
        .btn-primary { background-color: var(--primary); color: white; }
        .btn-gold { 
            background: linear-gradient(90deg, #FFD700 0%, #FFA500 100%); 
            color: black;
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.4);
        }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }

        /* –§–æ—Ä–º—ã */
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            margin-bottom: 15px;
            box-sizing: border-box;
            font-size: 16px;
        }
        label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 14px; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –µ–¥—ã */
        .meal-card {
            background: #fff;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary);
        }
        .meal-header { display: flex; justify-content: space-between; align-items: center; }
        .meal-title { font-weight: bold; font-size: 16px; }
        .meal-weight { font-weight: bold; color: var(--primary); }
        .meal-recipe { font-size: 13px; color: #666; margin-top: 5px; font-style: italic; line-height: 1.4;}
        
        .swap-btn {
            background: none; border: none; cursor: pointer; font-size: 18px; padding: 0 0 0 10px;
        }

        .price-tag {
            text-align: center;
            font-size: 24px;
            font-weight: 800;
            margin: 20px 0;
            color: var(--primary);
        }

        .macro-row { display: flex; justify-content: space-around; margin-bottom: 15px; text-align: center; }
        .macro-box { background: #fff; padding: 10px; border-radius: 8px; width: 30%; font-size: 13px; }
        .macro-val { font-weight: bold; font-size: 16px; display: block; }
    </style>
</head>
<body>

    <div id="page1" class="page active-page">
        <div class="card">
            <h1>üëë –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω</h1>
            <p style="text-align:center; opacity:0.7; font-size:14px;">–æ—Ç @LeonovTrener</p>
            
            <p>–≠—Ç–æ —É—Å–ª—É–≥–∞ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —á—ë—Ç–∫–∏–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π —Å —É—á—ë—Ç–æ–º —Ü–µ–ª–µ–π –∏ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏.</p>

            <ul class="benefits-list">
                <li><span class="check">‚úÖ</span> <b>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω</b><br>–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –≤–∞—Å, –±–µ–∑ –∂—ë—Å—Ç–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.</li>
                <li><span class="check">‚úÖ</span> <b>–¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ö–ë–ñ–£</b><br>–ë–∞–ª–∞–Ω—Å –¥–ª—è –ø–æ—Ö—É–¥–µ–Ω–∏—è, –º–∞—Å—Å—ã –∏–ª–∏ —Ä–µ–ª—å–µ—Ñ–∞.</li>
                <li><span class="check">‚úÖ</span> <b>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–µ–Ω–µ—Ä–∞</b><br>–û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –≤ —Ä–∞–º–∫–∞—Ö —Ç–∞—Ä–∏—Ñ–∞.</li>
            </ul>

            <div class="price-tag">3 000 ‚ÇΩ</div>
            
            <button class="btn btn-primary" onclick="goToPage('page2')">üî• –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ<br><span style="font-size:12px; font-weight:normal">–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–µ–º–æ-–º–µ–Ω—é –Ω–∞ 3 –¥–Ω—è</span></button>
        </div>
    </div>

    <div id="page2" class="page">
        <h2>üìä –¢–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ</h2>
        <div class="card">
            <label>–ü–æ–ª</label>
            <select id="gender"><option value="male">–ú—É–∂—Å–∫–æ–π</option><option value="female">–ñ–µ–Ω—Å–∫–∏–π</option></select>
            
            <label>–í–µ—Å (–∫–≥)</label>
            <input type="number" id="weight" placeholder="70">
            
            <label>–†–æ—Å—Ç (—Å–º)</label>
            <input type="number" id="height" placeholder="175">
            
            <label>–í–æ–∑—Ä–∞—Å—Ç</label>
            <input type="number" id="age" placeholder="25">
            
            <label>–¶–µ–ª—å</label>
            <select id="goal">
                <option value="lose">–ü–æ—Ö—É–¥–µ–Ω–∏–µ</option>
                <option value="maintain">–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ</option>
                <option value="gain">–ù–∞–±–æ—Ä –º–∞—Å—Å—ã</option>
            </select>
            
            <label>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</label>
            <select id="activity">
                <option value="1.2">–°–∏–¥—è—á–∞—è —Ä–∞–±–æ—Ç–∞</option>
                <option value="1.375">1-3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</option>
                <option value="1.55">3-5 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</option>
                <option value="1.725">–°–ø–æ—Ä—Ç—Å–º–µ–Ω</option>
            </select>

            <button class="btn btn-primary" onclick="calculateAndGo()">üöÄ –°–æ–∑–¥–∞—Ç—å —Ä–∞—Ü–∏–æ–Ω</button>
            <button class="btn btn-outline" onclick="goToPage('page1')" style="margin-top:5px; border:none;">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <div id="page3" class="page">
        <h3>üçΩ –¢–≤–æ–π –ø–ª–∞–Ω –Ω–∞ 3 –¥–Ω—è</h3>
        <p style="text-align: center; font-size: 13px; color: #666;">–ù–∞–∂–º–∏ üîÑ —á—Ç–æ–±—ã –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç</p>
        
        <div class="card" style="padding: 10px;">
            <div class="macro-row">
                <div class="macro-box">–ö–∫–∞–ª<span class="macro-val" id="resCal">0</span></div>
                <div class="macro-box">–ë–µ–ª–æ–∫<span class="macro-val" id="resProt">0</span></div>
                <div class="macro-box">–ñ–∏—Ä—ã<span class="macro-val" id="resFat">0</span></div>
            </div>
        </div>

        <div style="display:flex; justify-content:center; gap:10px; margin-bottom:15px;">
            <button class="btn btn-outline" style="width:auto; padding:8px 15px; margin:0;" onclick="showDay(1)">–î–µ–Ω—å 1</button>
            <button class="btn btn-outline" style="width:auto; padding:8px 15px; margin:0;" onclick="showDay(2)">–î–µ–Ω—å 2</button>
            <button class="btn btn-outline" style="width:auto; padding:8px 15px; margin:0;" onclick="showDay(3)">–î–µ–Ω—å 3</button>
        </div>

        <div id="mealsContainer"></div>

        <button class="btn btn-gold" onclick="goToPage('page4')">üëë –•–æ—á—É –º–µ–Ω—é –Ω–∞ –º–µ—Å—è—Ü</button>
    </div>

    <div id="page4" class="page">
        <div class="card" style="text-align: center; padding: 30px 20px;">
            <div style="font-size: 50px;">üí™</div>
            <h2>–ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ø–ª–∞–Ω?</h2>
            <p>–≠—Ç–æ –±—ã–ª –¥–µ–º–æ-—Ä–µ–∂–∏–º –Ω–∞ 3 –¥–Ω—è.</p>
            <p>–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å <b>–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –Ω–∞ 30 –¥–Ω–µ–π</b> —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç—Ä–µ–Ω–µ—Ä–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ–¥ —Ç–≤–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.</p>
            
            <div class="price-tag">–í—Å–µ–≥–æ 3 000 ‚ÇΩ</div>

            <a href="https://t.me/leonov_vitaliy48" class="btn btn-gold">‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Ç—Ä–µ–Ω–µ—Ä—É</a>
            <button class="btn btn-outline" onclick="goToPage('page3')">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–µ–Ω—é</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let userCalories = 0;
        
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –º–µ–Ω—é (–ø–æ 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –ø—Ä–∏–µ–º)
        const menuData = {
            1: [
                { type: "–ó–∞–≤—Ç—Ä–∞–∫", 
                  opt1: {name: "–û–≤—Å—è–Ω–∫–∞ —Å —è–≥–æ–¥–∞–º–∏", w: 60, u: "–≥ (—Å—É—Ö)", rec: "–í–∞—Ä–∏—Ç—å –Ω–∞ –≤–æ–¥–µ/–º–æ–ª–æ–∫–µ, –¥–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä—Å—Ç—å —è–≥–æ–¥."},
                  opt2: {name: "–°–∫—Ä—ç–º–±–ª –∏–∑ —è–∏—Ü", w: 3, u: "—à—Ç", rec: "–í–∑–±–∏—Ç—å —è–π—Ü–∞, –∂–∞—Ä–∏—Ç—å –Ω–∞ –∫–∞–ø–ª–µ –º–∞—Å–ª–∞, –ø–æ–º–µ—à–∏–≤–∞—è."} 
                },
                { type: "–ü–µ—Ä–µ–∫—É—Å", 
                  opt1: {name: "–Ø–±–ª–æ–∫–æ + –û—Ä–µ—Ö–∏", w: 1, u: "—à—Ç", rec: "–û—Ä–µ—Ö–æ–≤ 20-30–≥."},
                  opt2: {name: "–ì—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç", w: 150, u: "–≥", rec: "–ë–µ–∑ –¥–æ–±–∞–≤–æ–∫."} 
                },
                { type: "–û–±–µ–¥", 
                  opt1: {name: "–ì—Ä–µ—á–∫–∞ + –ö—É—Ä–∏—Ü–∞", w: 70, u: "–≥ (—Å—É—Ö)", rec: "–§–∏–ª–µ —Ç—É—à–∏—Ç—å –∏–ª–∏ –≤–∞—Ä–∏—Ç—å. –ö—Ä—É–ø—É –æ—Ç–≤–∞—Ä–∏—Ç—å."},
                  opt2: {name: "–†–∏—Å + –ò–Ω–¥–µ–π–∫–∞", w: 70, u: "–≥ (—Å—É—Ö)", rec: "–ò–Ω–¥–µ–π–∫—É –Ω–∞—Ä–µ–∑–∞—Ç—å, —Ç—É—à–∏—Ç—å —Å –æ–≤–æ—â–∞–º–∏."} 
                },
                { type: "–£–∂–∏–Ω", 
                  opt1: {name: "–ë–µ–ª–∞—è —Ä—ã–±–∞ + –°–∞–ª–∞—Ç", w: 200, u: "–≥", rec: "–†—ã–±—É –∑–∞–ø–µ—á—å –≤ —Ñ–æ–ª—å–≥–µ (20 –º–∏–Ω –ø—Ä–∏ 180–°)."},
                  opt2: {name: "–¢–≤–æ—Ä–æ–≥ 5%", w: 180, u: "–≥", rec: "–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–∞—Ö–∑–∞–º –∏–ª–∏ –∫–æ—Ä–∏—Ü—É."} 
                }
            ],
            2: [
                 { type: "–ó–∞–≤—Ç—Ä–∞–∫", opt1: {name: "–û–º–ª–µ—Ç —Å –æ–≤–æ—â–∞–º–∏", w: 3, u: "—à—Ç", rec: "–°–º–µ—à–∞—Ç—å —Å –ø–æ–º–∏–¥–æ—Ä–∞–º–∏, –ø–æ–¥ –∫—Ä—ã—à–∫–æ–π 5 –º–∏–Ω."}, opt2: {name: "–ì—Ä–∞–Ω–æ–ª–∞", w: 60, u: "–≥", rec: "–ó–∞–ª–∏—Ç—å –º–æ–ª–æ–∫–æ–º –∏–ª–∏ –π–æ–≥—É—Ä—Ç–æ–º."} },
                 { type: "–ü–µ—Ä–µ–∫—É—Å", opt1: {name: "–ë–∞–Ω–∞–Ω", w: 1, u: "—à—Ç", rec: ""}, opt2: {name: "–ö–µ—Ñ–∏—Ä", w: 250, u: "–º–ª", rec: "1% –∏–ª–∏ 2.5%"} },
                 { type: "–û–±–µ–¥", opt1: {name: "–ú–∞–∫–∞—Ä–æ–Ω—ã —Ç/—Å + –ì–æ–≤—è–¥–∏–Ω–∞", w: 70, u: "–≥ (—Å—É—Ö)", rec: "–ì–æ–≤—è–¥–∏–Ω—É —Ç—É—à–∏—Ç—å 1.5—á –¥–æ –º—è–≥–∫–æ—Å—Ç–∏."}, opt2: {name: "–ë—É–ª–≥—É—Ä + –ö–æ—Ç–ª–µ—Ç—ã", w: 70, u: "–≥ (—Å—É—Ö)", rec: "–ö–æ—Ç–ª–µ—Ç—ã –Ω–∞ –ø–∞—Ä—É –∏–ª–∏ –≤ –¥—É—Ö–æ–≤–∫–µ."} },
                 { type: "–£–∂–∏–Ω", opt1: {name: "–°–∞–ª–∞—Ç —Å –¢—É–Ω—Ü–æ–º", w: 1, u: "–ø–æ—Ä—Ü–∏—è", rec: "–¢—É–Ω–µ—Ü –≤ —Å/—Å + –æ–≥—É—Ä–µ—Ü + –ª–∏—Å—Ç—å—è —Å–∞–ª–∞—Ç–∞."}, opt2: {name: "–ö—É—Ä–∏–Ω–æ–µ —Ñ–∏–ª–µ + –ë—Ä–æ–∫–∫–æ–ª–∏", w: 150, u: "–≥", rec: "–í—Å–µ –æ—Ç–≤–∞—Ä–∏—Ç—å."} }
            ],
            3: [
                 { type: "–ó–∞–≤—Ç—Ä–∞–∫", opt1: {name: "–°—ã—Ä–Ω–∏–∫–∏ (–ü–ü)", w: 180, u: "–≥", rec: "–ù–∞ —Ä–∏—Å–æ–≤–æ–π –º—É–∫–µ, –∂–∞—Ä–∏—Ç—å –Ω–∞ –∞/–ø —Å–∫–æ–≤–æ—Ä–æ–¥–µ."}, opt2: {name: "–¢–æ—Å—Ç—ã —Å –∞–≤–æ–∫–∞–¥–æ", w: 2, u: "—à—Ç", rec: "–•–ª–µ–± —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π + –ø–æ–ª–æ–≤–∏–Ω–∞ –∞–≤–æ–∫–∞–¥–æ."} },
                 { type: "–ü–µ—Ä–µ–∫—É—Å", opt1: {name: "–ê–ø–µ–ª—å—Å–∏–Ω", w: 1, u: "—à—Ç", rec: ""}, opt2: {name: "–ì–æ—Ä—å–∫–∏–π —à–æ–∫–æ–ª–∞–¥", w: 20, u: "–≥", rec: "–ö —á–∞—é."} },
                 { type: "–û–±–µ–¥", opt1: {name: "–ü—é—Ä–µ + –†—ã–±–Ω–∞—è –∫–æ—Ç–ª–µ—Ç–∞", w: 200, u: "–≥", rec: "–ü—é—Ä–µ –Ω–∞ –≤–æ–¥–µ —Å –º–æ–ª–æ–∫–æ–º, –±–µ–∑ –º–∞—Å–ª–∞."}, opt2: {name: "–ü–ª–æ–≤ —Å –∫—É—Ä–∏—Ü–µ–π", w: 250, u: "–≥", rec: "–ì–æ—Ç–æ–≤–∏—Ç—å —Å –º–∏–Ω–∏–º—É–º–æ–º –º–∞—Å–ª–∞."} },
                 { type: "–£–∂–∏–Ω", opt1: {name: "–ö–∞–ª—å–º–∞—Ä—ã / –ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã", w: 200, u: "–≥", rec: "–û—Ç–≤–∞—Ä–∏—Ç—å 3 –º–∏–Ω, —Å–±—Ä—ã–∑–Ω—É—Ç—å –ª–∏–º–æ–Ω–æ–º."}, opt2: {name: "–°–∞–ª–∞—Ç –ì—Ä–µ—á–µ—Å–∫–∏–π", w: 250, u: "–≥", rec: "–ë—Ä—ã–Ω–∑–∞, –º–∞—Å–ª–∏–Ω—ã, –æ–≤–æ—â–∏, –º–∞—Å–ª–æ."} }
            ]
        };

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function goToPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.getElementById(pageId).classList.add('active-page');
            window.scrollTo(0, 0);
        }

        function calculateAndGo() {
            const gender = document.getElementById('gender').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            const age = parseFloat(document.getElementById('age').value);
            const activity = parseFloat(document.getElementById('activity').value);
            const goal = document.getElementById('goal').value;

            if (!weight || !height || !age) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
                return;
            }

            let bmr = (gender === 'male') 
                ? (10 * weight + 6.25 * height - 5 * age + 5)
                : (10 * weight + 6.25 * height - 5 * age - 161);

            let tdee = bmr * activity;
            if (goal === 'lose') tdee *= 0.8;
            if (goal === 'gain') tdee *= 1.15;

            userCalories = Math.round(tdee);

            // –û–±–Ω–æ–≤–ª—è–µ–º —à–∞–ø–∫—É –ë–ñ–£
            document.getElementById('resCal').innerText = userCalories;
            document.getElementById('resProt').innerText = Math.round((userCalories * 0.3) / 4);
            document.getElementById('resFat').innerText = Math.round((userCalories * 0.3) / 9);
            
            showDay(1); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º 1 –¥–µ–Ω—å
            goToPage('page3');
        }

        // –†–µ–Ω–¥–µ—Ä –º–µ–Ω—é
        function showDay(dayNum) {
            const container = document.getElementById('mealsContainer');
            container.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å
            
            const dayMeals = menuData[dayNum];
            const ratio = userCalories / 2000; // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç

            dayMeals.forEach((meal, index) => {
                // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∞ –∫–Ω–æ–ø–∫–∞ –∑–∞–º–µ–Ω—ã
                const uniqueId = `d${dayNum}_m${index}`;
                
                // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–ø—Ü–∏—é 1
                container.innerHTML += createMealHTML(meal, ratio, uniqueId, 1);
            });
        }

        function createMealHTML(meal, ratio, id, activeOpt) {
            const item = (activeOpt === 1) ? meal.opt1 : meal.opt2;
            
            // –†–∞—Å—á–µ—Ç –≤–µ—Å–∞
            let weight = item.w;
            if (item.u.includes('–≥') || item.u.includes('–º–ª')) {
                weight = Math.round(item.w * ratio);
            }

            return `
            <div class="meal-card" id="${id}">
                <div class="meal-header">
                    <span class="meal-title" style="color:#007aff">${meal.type}</span>
                    <button class="swap-btn" onclick="toggleMeal('${id}', ${activeOpt})">üîÑ</button>
                </div>
                <div class="meal-header" style="margin-top:5px;">
                    <span class="meal-title">${item.name}</span>
                    <span class="meal-weight">${weight} ${item.u}</span>
                </div>
                <div class="meal-recipe">üë®‚Äçüç≥ ${item.rec}</div>
                <div style="display:none" data-json='${JSON.stringify(meal)}'></div>
            </div>`;
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—ã (–°–≤–∞–ø)
        window.toggleMeal = function(id, currentOpt) {
            // –ù–∞—Ö–æ–¥–∏–º –∫–∞—Ä—Ç–æ—á–∫—É
            const card = document.getElementById(id);
            // –î–æ—Å—Ç–∞–µ–º —Å–ø—Ä—è—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–æ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏
            const mealData = JSON.parse(card.querySelector('div[data-json]').innerText);
            const ratio = userCalories / 2000;
            
            // –ú–µ–Ω—è–µ–º 1 –Ω–∞ 2, –∏–ª–∏ 2 –Ω–∞ 1
            const newOpt = (currentOpt === 1) ? 2 : 1;
            
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É (outerHTML –∑–∞–º–µ–Ω—è–µ—Ç —Å–∞–º —ç–ª–µ–º–µ–Ω—Ç)
            card.outerHTML = createMealHTML(mealData, ratio, id, newOpt);
        }

    </script>
</body>
</html>
